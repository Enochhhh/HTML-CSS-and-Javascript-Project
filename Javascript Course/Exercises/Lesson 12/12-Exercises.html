<!DOCTYPE html>

<html>
  <head>
    <title>12-Exercises Practices</title>
  </head>
  <body>
    <!-- Exercise 12c, 12d -->
    <p>Exercise 12c, 12d</p>
    <button class="js-start-button">Start</button>

    <!-- Exercise 12e, 12f -->
    <p>Exercise 12e, 12f</p>
    <button class="js-add-to-cart-button">Add to cart</button>
    <p class="js-message-added"></p>

    <!-- Exercise 12h, 12i -->
    <p>Exercise 12h, 12i</p>
    <button class="js-add-message-button">Add</button>
    <button class="js-remove-message-button">Remove</button>

    <script>
      // Exercise 12a
      console.log('>>> *** Exercise 12a ***<<<');
      const add = function() {
        console.log(2 + 3);
      }
      add();
      add();

      // Exercise 12b
      console.log('>>> *** Exercise 12b ***<<<');
      function runTwice(fun) {
        fun();
        console.log(typeof fun);
      }
      runTwice(function() {
        console.log('12b');
      });
      runTwice(add);

      // Exercise 12c, 12d
      console.log('>>> *** Exercise 12c, 12d ***<<<');
      document.querySelector('.js-start-button')
        .addEventListener('click', () => {
          changeToFinished();
        });
      function changeToFinished() {
        setTimeout(() => {
          document.querySelector('.js-start-button').innerHTML = 'Finished!';
        }, 1000);
        document.querySelector('.js-start-button').innerHTML = 'Loading...';
      }

      // Exercise 12e, 12f
      console.log('>>> *** Exercise 12e, 12f ***<<<');
      document.querySelector('.js-add-to-cart-button')
        .addEventListener('click', () => {
          addToCart();
        });

      let isRefreshed = true;
      let idTimeOut;
      function addToCart() {
        if (!isRefreshed) {
          clearTimeout(idTimeOut); 
        } 
        isRefreshed = false;
        idTimeOut = setTimeout(function() {
          document.querySelector('.js-message-added').innerHTML = '';
          isRefreshed = true;
        }, 1000);
        document.querySelector('.js-message-added').innerHTML = 'Added';
      }

      // Exercise 12g
      console.log('>>> *** Exercise 12g ***<<<');
      let amountMessages = 2;
      setInterval(() => {
        const titleElement = document.querySelector('title');
        if (amountMessages > 0 && titleElement.innerHTML === '12-Exercises Practices') {
          titleElement.innerHTML = `(${amountMessages}) New messages`;
        } else {
          titleElement.innerHTML = '12-Exercises Practices';
        }
      }, 1000);
      
      // Exercise 12h, 12i
      console.log('>>> *** Exercise 12h, 12i ***<<<');
      document.querySelector('.js-add-message-button')
        .addEventListener('click', () => {
          addMessage(1);
        });
      document.querySelector('.js-remove-message-button')
        .addEventListener('click', () => {
          addMessage(-1);
        });
      
      function addMessage(number) {
        amountMessages += number;
        if (amountMessages < 0) {
          amountMessages = 0;
        }
      }
    </script>
  </body>
</html>